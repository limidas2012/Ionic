<ion-header>
    <ion-navbar>
        <ion-title>{{"my_profile" | translate}}</ion-title>
    </ion-navbar>
</ion-header>

<ion-content class="bg-light">

    <ion-list no-lines class="profile">
        <ion-item style="position: relative;z-index: 2;" style="margin-bottom: 0px !important;">
            <ion-avatar item-start (click)="pickPicker(1)" class="center_img">
                <img *ngIf="profile && profile.user && profile.user.image_url" data-src="{{profile.user.image_url}}" class="crop_img">
                <img *ngIf="!profile || !profile.user || !profile.user.image_url" src="assets/imgs/empty_dp.png" class="crop_img">
            </ion-avatar>
            <div class="name">
                <h2 class="d-flex">{{user.name}}
                    <ion-icon *ngIf="profile.is_verified == 1" name="ios-checkmark-circle" class="text-theme">
                    </ion-icon>
                </h2>

                <p class="d-flex">
                    <span class="rating_icons">
						<ion-icon [ngClass]="(user.ratings >= 1) ? 'text-yellow' : ''" name="ios-star"></ion-icon>
						<ion-icon [ngClass]="(user.ratings >= 2) ? 'text-yellow' : ''" name="ios-star"></ion-icon>
						<ion-icon [ngClass]="(user.ratings >= 3) ? 'text-yellow' : ''" name="ios-star"></ion-icon>
						<ion-icon [ngClass]="(user.ratings >= 4) ? 'text-yellow' : ''" name="ios-star"></ion-icon>
						<ion-icon [ngClass]="(user.ratings >= 5) ? 'text-yellow' : ''" name="ios-star"></ion-icon>
					</span> ({{user.ratingscount}} {{"reviews" | translate}})
                </p>

            </div>
        </ion-item>

        <div class="tabs bg-white">
            <ion-segment [(ngModel)]="myprofile_tab">
                <ion-segment-button value="about">
                    {{"about" | translate}}
                </ion-segment-button>
                <ion-segment-button value="reviews">
                    {{"reviews" | translate}}
                </ion-segment-button>
            </ion-segment>
        </div>
    </ion-list>

    <div class="tab_container" style="margin-bottom: 50px;" [ngSwitch]="myprofile_tab">
        <div class="container about_section" *ngSwitchCase="'about'" style="padding-top: 7px;">
            <ion-list no-lines>
                <div class="bg-white about info animate__animated animate__fadeInUp" style="padding-bottom: 20px !important;">
                    <p class="text-theme heading">{{"personal" | translate}}</p>
                    <ion-list no-lines class="form-list">
                        <ion-item style="margin-bottom: 0px !important;">
                            <ion-label>{{"profession" | translate}}</ion-label>
                            <ion-input type="text" placeholder="{{'enter_your_profession' | translate}}" [(ngModel)]="profile.profession"></ion-input>
                        </ion-item>
                    </ion-list>
                </div>
                <div class="bg-white about info animate__animated animate__fadeInUp">
                    <p class="text-theme heading animate__animated animate__fadeInUp">{{"verification" | translate}}</p>
                    <ion-list no-lines class="form-list">
                        <ion-item class="animate__animated animate__fadeInUp">
                            <ion-label>{{"email" | translate}}</ion-label>
                            <ion-input type="text" value="{{user.email}}" readonly></ion-input>
                        </ion-item>
                        <ion-item class="animate__animated animate__fadeInUp">
                            <ion-label>{{"phone" | translate}}</ion-label>
                            <ion-input type="text" value="{{user.mobile_number}}" readonly></ion-input>
                        </ion-item>
                        <ion-item class="doc_verification animate__animated animate__fadeInUp" (click)="pickPicker(2)" style="margin-bottom: 0px !important;">
                            <ion-label item-start>{{"verification_type3" | translate}}</ion-label>
                            <div class="" item-end>
                                <p *ngIf="profile.document_url">{{"verification_pending" | translate}}</p>
                                <p *ngIf="!profile.document_url">{{"verification_done" | translate}}</p>
                            </div>
                        </ion-item>
                    </ion-list>
                </div>
                <div class="bg-white about info animate__animated animate__fadeInUp">
                    <p class="text-theme heading">{{"car_info" | translate}}</p>
                    <ion-list *ngIf="profile.vehicle_details_array && profile.vehicle_details_array.length" no-lines class="form-list">
                        <ion-row>
                            <ion-col class="animate__animated animate__fadeInUp" col-12>
                                <ion-item>
                                    <ion-label>{{"car_brand" | translate}}</ion-label>
                                    <ion-input type="text" placeholder="{{'enter_car_brand' | translate}}" [(ngModel)]="profile.vehicle_details_array[0]">
                                    </ion-input>
                                </ion-item>
                            </ion-col>
                            <ion-col class="animate__animated animate__fadeInUp" col-12>
                                <ion-item>
                                    <ion-label>{{"car_model" | translate}}</ion-label>
                                    <ion-input type="text" placeholder="{{'enter_car_model' | translate}}" [(ngModel)]="profile.vehicle_details_array[1]">
                                    </ion-input>
                                </ion-item>
                            </ion-col>
                            <ion-col class="animate__animated animate__fadeInUp" col-12>
                                <ion-item>
                                    <ion-label>{{"car_color" | translate}}</ion-label>
                                    <ion-input type="text" placeholder="{{'enter_car_color' | translate}}" [(ngModel)]="profile.vehicle_details_array[2]">
                                    </ion-input>
                                </ion-item>
                            </ion-col>
                            <ion-col class="animate__animated animate__fadeInUp" col-12>
                                <ion-item>
                                    <ion-label>{{"car_no" | translate}}</ion-label>
                                    <ion-input type="text" placeholder="{{'enter_car_nomber' | translate}}" [(ngModel)]="profile.vehicle_details_array[4]">
                                    </ion-input>
                                </ion-item>
                            </ion-col>
                            <ion-col class="animate__animated animate__fadeInUp" col-12>
                                <ion-item>
                                    <ion-label>{{"ac_option" | translate}}</ion-label>
                                    <ion-select [(ngModel)]="profile.vehicle_details_array[3]" cancelText="{{'cancel' | translate}}" okText="{{'okay' | translate}}">
                                        <ion-option value="{{'available' | translate}}">{{"available" | translate}}
                                        </ion-option>
                                        <ion-option value="{{'unavailable' | translate}}">{{"unavailable" | translate}}
                                        </ion-option>
                                    </ion-select>
                                </ion-item>
                            </ion-col>
                            <ion-col class="animate__animated animate__fadeInUp" col-12>
                                <ion-item>
                                    <ion-label>{{"passenger_seat" | translate}}</ion-label>
                                    <ion-select [(ngModel)]="profile.seats" cancelText="{{'cancel' | translate}}" okText="{{'okay' | translate}}">
                                        <ion-option value="1">1 {{"seat" | translate}}</ion-option>
                                        <ion-option value="2">2 {{"seatss" | translate}}</ion-option>
                                        <ion-option value="3">3 {{"seatss" | translate}}</ion-option>
                                        <ion-option value="4">4 {{"seatss" | translate}}</ion-option>
                                        <ion-option value="5">5 {{"seatss" | translate}}</ion-option>
                                        <ion-option value="6">6 {{"seatss" | translate}}</ion-option>
                                        <ion-option value="7">7 {{"seatss" | translate}}</ion-option>
                                    </ion-select>
                                </ion-item>
                            </ion-col>
                        </ion-row>
                    </ion-list>
                </div>
            </ion-list>
        </div>

        <div class="container" *ngSwitchCase="'reviews'">
            <div class="empty-view animate__animated animate__zoomIn" style="--animate-duration: .2s;" *ngIf="!isLoadingReviews && (!reviews || !reviews.length)">
                <div style="text-align:center">
                    <img src="assets/imgs/empty_reviews.png" alt="no offers" />
                    <span style="color:#9E9E9E; font-weight:bold;">{{'no_reviews_to_show' | translate}}</span>
                </div>
            </div>
            <ion-list class="reviews">
                <div *ngIf="rating && reviews && reviews.length" class="bg-white" padding style="margin-bottom: 4px;">
                    <div class="rating-box">
                        <p class="animate__animated animate__fadeInUp">
                            <span class="text-1">5<ion-icon name="md-star"></ion-icon></span>
                            <span class="rate-bar">
								<span class="bg-theme" [style.width]="rating.summary[4].percent+'%'"></span>
                            </span>
                            <span class="text-2">{{rating.summary[4].total}}</span>
                        </p>
                        <p class="animate__animated animate__fadeInUp">
                            <span class="text-1">4<ion-icon name="md-star"></ion-icon></span>
                            <span class="rate-bar">
								<span class="bg-theme" [style.width]="rating.summary[3].percent+'%'"></span>
                            </span>
                            <span class="text-2">{{rating.summary[3].total}}</span>
                        </p>
                        <p class="animate__animated animate__fadeInUp">
                            <span class="text-1">3<ion-icon name="md-star"></ion-icon></span>
                            <span class="rate-bar">
								<span class="bg-theme" [style.width]="rating.summary[2].percent+'%'"></span>
                            </span>
                            <span class="text-2">{{rating.summary[2].total}}</span>
                        </p>
                        <p class="animate__animated animate__fadeInUp">
                            <span class="text-1">2<ion-icon name="md-star"></ion-icon></span>
                            <span class="rate-bar">
								<span class="bg-theme" [style.width]="rating.summary[1].percent+'%'"></span>
                            </span>
                            <span class="text-2">{{rating.summary[1].total}}</span>
                        </p>
                        <p class="animate__animated animate__fadeInUp">
                            <span class="text-1">1<ion-icon name="md-star"></ion-icon></span>
                            <span class="rate-bar">
								<span class="bg-theme" [style.width]="rating.summary[0].percent+'%'"></span>
                            </span>
                            <span class="text-2">{{rating.summary[0].total}}</span>
                        </p>
                    </div>
                </div>

                <ion-card class="review_box">
                    <ion-item class="animate__animated animate__fadeInUp" *ngFor="let review of reviews">
                        <ion-avatar class="center_img" item-start>
                            <img *ngIf="review.rating_from && review.rating_from.image_url" data-src="{{review.rating_from.image_url}}" class="crop_img">
                            <img *ngIf="!review.rating_from || !review.rating_from.image_url" src="assets/imgs/empty_dp.png" class="crop_img">
                        </ion-avatar>
                        <div class="text_box">
                            <h2 class="d-flex"><span class="name">{{review.rating_from.name}}</span>
                                <span class="end">{{review.created_at}}</span>
                            </h2>
                            <h3 class="d-flex">
                                <ion-icon name="ios-star" [ngClass]="(review.rating >= 1) ? 'text-yellow' : ''">
                                </ion-icon>
                                <ion-icon name="ios-star" [ngClass]="(review.rating >= 2) ? 'text-yellow' : ''">
                                </ion-icon>
                                <ion-icon name="ios-star" [ngClass]="(review.rating >= 3) ? 'text-yellow' : ''">
                                </ion-icon>
                                <ion-icon name="ios-star" [ngClass]="(review.rating >= 4) ? 'text-yellow' : ''">
                                </ion-icon>
                                <ion-icon name="ios-star" [ngClass]="(review.rating >= 5) ? 'text-yellow' : ''">
                                </ion-icon>
                            </h3>
                            <p>{{review.review}}</p>
                        </div>
                    </ion-item>
                </ion-card>
            </ion-list>
        </div>
    </div>
</ion-content>

<ion-footer no-border class="animate__animated animate__fadeInUp" style="--animate-duration: .4s;">
    <button *ngIf="myprofile_tab == 'about'" ion-button full class="bg-theme text-white btn" (click)="saveProfile()">
		{{"update_info" | translate}}
	</button>
</ion-footer>